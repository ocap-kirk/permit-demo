/**
 * Store for contexted passed as part of check() queries
 */
export class ContextStore {
    baseContext = {}; // cross-query context (global context)
    transforms = [];
    /**
     * add context to the base context
     */
    add(context) {
        this.baseContext = Object.assign(this.baseContext, context);
    }
    registerTransform(transform) {
        this.transforms.push(transform);
    }
    /**
     * merges the global context (this.context) with the context
     * provided for this specific query (context). the specific
     * context overrides the base (global) context.
     */
    getDerivedContext(context) {
        return Object.assign({}, this.baseContext, context);
    }
    transform(initialContext) {
        let context = { ...initialContext };
        for (const transform of this.transforms) {
            context = transform(context);
        }
        return context;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9jb250ZXh0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWFBOztHQUVHO0FBQ0gsTUFBTSxPQUFPLFlBQVk7SUFDZixXQUFXLEdBQVksRUFBRSxDQUFDLENBQUMsdUNBQXVDO0lBQ2xFLFVBQVUsR0FBdUIsRUFBRSxDQUFDO0lBRTVDOztPQUVHO0lBQ0ksR0FBRyxDQUFDLE9BQWdCO1FBQ3pCLElBQUksQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzlELENBQUM7SUFFTSxpQkFBaUIsQ0FBQyxTQUEyQjtRQUNsRCxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLGlCQUFpQixDQUFDLE9BQWdCO1FBQ3ZDLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN0RCxDQUFDO0lBRU0sU0FBUyxDQUFDLGNBQXVCO1FBQ3RDLElBQUksT0FBTyxHQUFHLEVBQUUsR0FBRyxjQUFjLEVBQUUsQ0FBQztRQUNwQyxLQUFLLE1BQU0sU0FBUyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDdkMsT0FBTyxHQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUM5QjtRQUNELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7Q0FDRiJ9