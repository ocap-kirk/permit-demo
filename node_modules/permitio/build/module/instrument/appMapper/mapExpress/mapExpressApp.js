import _ from 'lodash';
import { pathToRegexp } from 'path-to-regexp';
import listEndpoints from './listEndpoints';
export const KEY_DELIMITER = ':';
export const PATH_DELIMITER = '/';
export function mapExpressAppEndpoints(app) {
    return _.map(listEndpoints(app), (endpoint) => {
        const regEx = pathToRegexp(endpoint.path);
        const keys = _.map(_.slice(regEx.exec(endpoint.path), 1), (key) => _.trimStart(key, KEY_DELIMITER));
        return {
            ...endpoint,
            regEx,
            keys: keys,
            endsWithKey: keys.length > 0
                ? endpoint.path.endsWith(`${KEY_DELIMITER}${keys[keys.length - 1]}`)
                : false,
        };
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwRXhwcmVzc0FwcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9pbnN0cnVtZW50L2FwcE1hcHBlci9tYXBFeHByZXNzL21hcEV4cHJlc3NBcHAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxDQUFDLE1BQU0sUUFBUSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUk5QyxPQUFPLGFBQWEsTUFBTSxpQkFBaUIsQ0FBQztBQUU1QyxNQUFNLENBQUMsTUFBTSxhQUFhLEdBQUcsR0FBRyxDQUFDO0FBQ2pDLE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBRyxHQUFHLENBQUM7QUFFbEMsTUFBTSxVQUFVLHNCQUFzQixDQUFDLEdBQW9CO0lBQ3pELE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxRQUF3QixFQUFFLEVBQUU7UUFDNUQsTUFBTSxLQUFLLEdBQUcsWUFBWSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxQyxNQUFNLElBQUksR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUNoRSxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRSxhQUFhLENBQUMsQ0FDaEMsQ0FBQztRQUNGLE9BQU87WUFDTCxHQUFHLFFBQVE7WUFDWCxLQUFLO1lBQ0wsSUFBSSxFQUFFLElBQUk7WUFDVixXQUFXLEVBQ1QsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDO2dCQUNiLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLGFBQWEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNwRSxDQUFDLENBQUMsS0FBSztTQUNaLENBQUM7SUFDSixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMifQ==