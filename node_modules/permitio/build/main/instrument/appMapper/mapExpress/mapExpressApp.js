"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.mapExpressAppEndpoints = exports.PATH_DELIMITER = exports.KEY_DELIMITER = void 0;
const lodash_1 = __importDefault(require("lodash"));
const path_to_regexp_1 = require("path-to-regexp");
const listEndpoints_1 = __importDefault(require("./listEndpoints"));
exports.KEY_DELIMITER = ':';
exports.PATH_DELIMITER = '/';
function mapExpressAppEndpoints(app) {
    return lodash_1.default.map(listEndpoints_1.default(app), (endpoint) => {
        const regEx = path_to_regexp_1.pathToRegexp(endpoint.path);
        const keys = lodash_1.default.map(lodash_1.default.slice(regEx.exec(endpoint.path), 1), (key) => lodash_1.default.trimStart(key, exports.KEY_DELIMITER));
        return Object.assign(Object.assign({}, endpoint), { regEx, keys: keys, endsWithKey: keys.length > 0
                ? endpoint.path.endsWith(`${exports.KEY_DELIMITER}${keys[keys.length - 1]}`)
                : false });
    });
}
exports.mapExpressAppEndpoints = mapExpressAppEndpoints;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwRXhwcmVzc0FwcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9pbnN0cnVtZW50L2FwcE1hcHBlci9tYXBFeHByZXNzL21hcEV4cHJlc3NBcHAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0Esb0RBQXVCO0FBQ3ZCLG1EQUE4QztBQUk5QyxvRUFBNEM7QUFFL0IsUUFBQSxhQUFhLEdBQUcsR0FBRyxDQUFDO0FBQ3BCLFFBQUEsY0FBYyxHQUFHLEdBQUcsQ0FBQztBQUVsQyxTQUFnQixzQkFBc0IsQ0FBQyxHQUFvQjtJQUN6RCxPQUFPLGdCQUFDLENBQUMsR0FBRyxDQUFDLHVCQUFhLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxRQUF3QixFQUFFLEVBQUU7UUFDNUQsTUFBTSxLQUFLLEdBQUcsNkJBQVksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsTUFBTSxJQUFJLEdBQUcsZ0JBQUMsQ0FBQyxHQUFHLENBQUMsZ0JBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUNoRSxnQkFBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUscUJBQWEsQ0FBQyxDQUNoQyxDQUFDO1FBQ0YsdUNBQ0ssUUFBUSxLQUNYLEtBQUssRUFDTCxJQUFJLEVBQUUsSUFBSSxFQUNWLFdBQVcsRUFDVCxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUM7Z0JBQ2IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcscUJBQWEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNwRSxDQUFDLENBQUMsS0FBSyxJQUNYO0lBQ0osQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBaEJELHdEQWdCQyJ9